## è¿è¡Œ

### ProTable å°è£…å¯ä»¥å‚è€ƒ
### https://github.com/TopAlien/base-admin-naive
### https://github.com/TopAlien/vue3-admin-cli
### https://procomponents.ant.design/components/table 

### 1ã€yarn install

### 2ã€yarn dev

## æ„å»º

### 1ã€build:dev æ‰“åŒ…å¼€å‘ç¯å¢ƒ

### 2ã€build:test æ‰“åŒ…æµ‹è¯•ç¯å¢ƒ

### 3ã€build:prod æ‰“åŒ…æ­£å¼ç¯å¢ƒ

... è‡ªå®šä¹‰å¯ä»¥å¢åŠ  .env.[mode]
... package.json scripts å¯¹åº” --mode [mode]

### åŠŸèƒ½/æŠ€æœ¯æ ˆ

- vue@3
- pinia
- vite@5
- less cssé¢„å¤„ç†å™¨, å˜é‡
- è¯·æ±‚ä½¿ç”¨åŸç”Ÿæ”¯æŒçš„fetchï¼ˆvueuse/useFetch hookï¼‰useFetchäºŒæ¬¡å°è£…, ä¸å†ä½¿ç”¨axios
- vue-router@4
- unocss - safeliståŠ è½½åŠ¨æ€icon class
- vueuse
- ant-design-vue@4.x - zh-cn ç»„ä»¶äºŒæ¬¡å°è£…slot, attrsé€ä¼ 
- smooth-scrollbarè‡ªå®šä¹‰æ»šåŠ¨æ¡ï¼ˆè‡ªå®šä¹‰æŒ‡ä»¤)
- å¯é…ç½®å³ä¾§contentæ¥å£è¯·åŠ è½½åŠ¨ç”»ï¼ˆå¦‚å›¾7ï¼‰ï¼Œè§service/index.js showLoadingé…ç½®
- å›¾è¡¨åº“ Echarts-v5
- å›¾è¡¨åº“ G2-5.0
- ç®€å•æ˜“ç”¨çš„æ‰“å°ï¼Œå±€éƒ¨æ‰“å° hiprintï¼Œç›´æ¥é¢„è§ˆï¼Œå¯¼å‡ºpdf
- lodash-esç‰ˆ æ–¹ä¾¿vite tree shake, å‡å°‘åŒ…ä½“ç§¯ï¼›æ‰€ä»¥æˆ‘ä»¬åœ¨é€‰æ‹©ç¬¬ä¸‰æ–¹åº“æ—¶ï¼Œè¦å°½å¯èƒ½ä½¿ç”¨ ESM ç‰ˆæœ¬ï¼Œå¯ä»¥æå‡ä¸å°‘æ€§èƒ½ï¼
- åˆ‡æ¢é¡µé¢å›åˆ°é¡¶éƒ¨ï¼ŒåŒºåŸŸæ»šåŠ¨routeræ— æ•ˆ
- Org Tree
- Calendar æ—¥å†
- idcard æ ¡éªŒèº«ä»½è¯[ç¬¬äºŒä»£]åˆæ³•æ€§ï¼Œè·å–èº«ä»½è¯è¯¦ç»†ä¿¡æ¯ï¼ˆå¯15ä½è½¬18ä½ï¼‰
- NProgress é¡µé¢åˆ‡æ¢è¿›åº¦æ¡
- åç«¯åŠ¨æ€è·¯ç”±åŒ¹é… config å¼€å¯åæŸ¥çœ‹ç¤ºä¾‹, æƒé™æ›´æ–°ååˆ·æ–°å³å¯ï¼Œæ— éœ€é‡æ–°ç™»å½•
- åŸºäºModalå°è£…useModalå‡½æ•°å¼è°ƒç”¨
- æµè§ˆå™¨å”¯ä¸€æ ‡è¯†ï¼Œç”¨äºæ¸¸å®¢è®°å½•ç­‰
- jsonç¾åŒ–é¢„è§ˆ/ç¼–è¾‘
- æŒ‰é’® v-loadingï¼ˆloadingåŠ¨ç”»ï¼‰è‡ªå®šä¹‰æŒ‡ä»¤ - èŠ‚æµ
- æŒ‰é’®çº§æƒé™æŒ‡ä»¤ v-auth.[moduleName]
- å…³é”®è¯é«˜äº®ç»„ä»¶TextMarkç»„ä»¶
- æ–‡æœ¬æº¢å‡ºæ˜¾ç¤º...ç»„ä»¶
- æ•°æ®ä½¿ç”¨[Apifoxäº‘ç«¯Mock](https://apifox.com/help/api-mock/cloud-mock)
- Tabsååœ†è§’
- TableåŒºåŸŸæ»šåŠ¨ï¼ˆè‡ªåŠ¨è®¡ç®—ï¼‰
- å›¾ç‰‡æ‡’åŠ è½½æŒ‡ä»¤

### import.meta.env è®¿é—®ç¯å¢ƒå˜é‡ï¼Œè‡ªå®šä¹‰ VITE\_ å¼€å¤´

### é¡¹ç›®éƒ¨åˆ†æˆªå›¾

![img14.png](public/img14.png)
![img15.png](public/img15.png)
![img16.png](public/img16.png)
![img.png](public/img.png)
![img.png](public/img1.png)
![img.png](public/img2.png)
![img.png](public/img3.png)
![img.png](public/img4.png)
![img5.png](public/img5.png)
![img.png](public/img6.png)
![img7.png](public/img7.png)
![img8.png](public/img8.png)
![img9.png](public/img9.png)
![img10.png](public/img10.png)
![img11.png](public/img11.png)
![img12.png](public/img12.png)
![img13.png](public/img13.png)

### è·¯ç”±é…ç½®

```js
const BASE_URL = '/other'[
  {
    // pathå¿…é¡»å†™å®Œæ•´çš„è·¯å¾„ï¼Œè¦åšè·³è½¬åŒ¹é…
    path: BASE_URL,
    component: Layout,
    name: 'Com',
    redirect: `${BASE_URL}/list-1/list2-1`, // ä¸å†éœ€è¦ï¼Œè‡ªåŠ¨é‡å®šå‘ç¬¬ä¸€ä¸ª
    // icon ä¸ºcarbonæ—¶åœ¨ï¼Œsafelistä¸­æ·»åŠ class
    // meta: { icon, hideInMenu, title }
    meta: {
      title: 'ç»„ä»¶',
      // éœ€è¦æ˜¾ç¤ºåˆ°column tabä¸­çš„åˆ†ç»„
      isGroup: true,
      icon: 'i-carbon-ibm-cloud-transit-gateway'
    },
    children: [
      {
        path: `${BASE_URL}/list-1`,
        redirect: `${BASE_URL}/list-1/list2-1`,
        name: 'List-1',
        meta: {
          title: 'åˆ—è¡¨-1',
          icon: 'i-carbon-list-boxes'
        }
      }
    ]
  }
]
```

## çœŸé¦™ğŸ‘

### [å›¾è¡¨æ¥è‡ª](http://ppchart.com/#/)

### [æ’ç”»](https://undraw.co/illustrations)

### [404æ’ç”»](https://error404.fun/)

### [æ‰“å°](https://www.npmjs.com/package/vue-plugin-hiprint)

### [æ•°æ®mock-Apifox](https://apifox.com/)

## å¼€å‘ç»éªŒ/ä¼˜åŒ–

1. é¿å…æ•´ä½“ç›‘å¬å¯¹è±¡ï¼Œä¼šéšå¼è§¦å‘deepã€‚åˆ†æ¸…æ¥šwatch({}), å’Œ watch(() => {}) ä½¿ç”¨åœºæ™¯

```js
const watState = reactive({ arr: [], count: 1, str: '123', bo: true })

// watch(watState.str, () => {})
// åŸå§‹å€¼ä¸èƒ½ç›´æ¥ç›‘å¬ï¼Œéœ€è¦ç”¨getterå‡½æ•°
// å¼•ç”¨å¯ä»¥ç›´æ¥ç›‘å¬ï¼Œä¼šéšå¼åˆ›å»ºdeepï¼Œç”¨åˆ°getterå‡½æ•°ï¼Œéœ€æ˜¾ç¤ºdeepç›‘å¬ï¼Œå¦åˆ™éœ€è¦æ•´ä½“æ›¿æ¢æ‰è§¦å‘watch ä¾‹ï¼š watState.arr = []
watch(
  () => watState.arr,
  (newVal, oldVal) => {
    message.success('è§¦å‘ï¼')
    console.log('-> newVal, oldVal', newVal, oldVal)
  }
)

const onWatch = () => {
  watState.arr = [{ name: 'ealien', age: '123', sex: '1' }]
}

const counter = ref(0)
// ä¸æ˜¯åŸå§‹å€¼ä¸èƒ½ç›´æ¥ç›‘å¬å—ï¼Ÿå•Šè¿™...ã€‚ åˆ«å¿˜äº†refè®¿é—®éœ€è¦ .valueå‘€ã€‚souga
watch(counter, (newVal, oldVal) => {
  console.log('-> newVal, oldVal', newVal, oldVal)
})
```

2. å­ç»„ä»¶æƒ³çŸ¥é“emitçˆ¶çº§åˆ°åº•ä¼ æ²¡ä¼ ï¼Ÿ

```vue
<!-- 1ã€çˆ¶ç»„ä»¶ -->
<ModalFooter @confirm="() => {}" />

<!-- 2ã€ModalFooter ç»„ä»¶ -->
const emit = defineEmits(['confirm', 'cancel'])

<!-- props åœ¨emitå‰é¢åŠ on å˜å˜å¥½ä½¿ -->
const props = defineProps({ onConfirm: { type: Function }, onCancel: { type: Function }, })

<!-- è¿™ä¸å°±æ¥äº†å˜›ï¼Œè¿™é‡Œç›´æ¥ç”¨æ¥åˆ¤æ–­å°±å®Œäº‹äº† -->
props.onConfirm props.onCancel
```

## æŒ‡ä»¤

1. v-loading

```js
const loading = `<span class="ant-btn-loading-icon"><span role="img" aria-label="loading" class="anticon anticon-loading anticon-spin"><svg focusable="false" data-icon="loading" width="1em" height="1em" fill="currentColor" aria-hidden="true" viewBox="0 0 1024 1024"><path d="M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"></path></svg><!----></span></span>`

/**
 * é€šè¿‡è‡ªå®šä¹‰æ ·å¼(global.less)ï¼Œå¯¹ primary ç±»å‹æŒ‰é’®ï¼Œå’Œå®˜æ–¹ç¤ºä¾‹ä¸€æ ·ã€‚äº‹ä»¶åªæ‰§è¡Œä¸€æ¬¡
 *
 * é»˜è®¤å€¼1500æ¯«ç§’
 * v-loading="2000"
 * v-loading == v-loading="1500"
 */
export default {
  mounted(el, binding) {
    const originInnerHtml = el.innerHTML

    if (binding.value && typeof binding.value !== 'number') {
      console.error('è‡ªå®šä¹‰æ—¶é—´åº”ä¸ºæ•°å­— ä¾‹ï¼š v-loading="2000"')
      return
    }

    el.addEventListener(
      'click',
      () => {
        if (!el.disabled) {
          el.disabled = true
          el.innerHTML = `${loading}${originInnerHtml}`

          setTimeout(() => {
            el.innerHTML = originInnerHtml
            el.disabled = false
          }, binding.value || 1500)
        }
      },
      false
    )
  }
}
```

2. v-auth æŒ‰é’®æƒé™æŒ‡ä»¤

```js
/**
 * è®¾è®¡åœºæ™¯
 *
 * 1ã€åå°æ–°å¢æƒé™æ—¶é€‰æ‹©ç±»å‹æ˜¯å¦æ˜¯æŒ‰é’®ï¼Œé€‰æ‹©æŒ‰é’®ç±»å‹ã€‚ç™»å½•åè°ƒå–æ¥å£æŸ¥å‡ºæ‰€æœ‰æŒ‰é’®ç±»å‹æƒé™ï¼š(æˆ‘ä½¿ç”¨æ¥å£ä½œä¸ºå”¯ä¸€æ ‡è¯†)
 * response = ['/user/list', '/user/add', '/user/detail/add', '/user/detail/edit']
 *
 * æŒ‡ä»¤ä½¿ç”¨æ ¼å¼
 * v-auth="'/user/list'"
 * v-auth="['/user/list', '/user/detail/edit']"
 *
 *
 * 2ã€æŒ‰ç…§èœå•æƒé™å±‚çº§è¿”å›ã€‚ç±»ä¼¼ mock ä¸­çš„ adminRoutesï¼Œå†å¢åŠ ç±»å‹åŒºåˆ†æ˜¯å¦æ˜¯æŒ‰é’®æƒé™å³å¯ã€‚
 * response = [{ key: 'user', children: [{ key: 'user/list', children: [{ type: 'btn', key: 'api/user/list' }] }] }]
 *
 * ä½¿ç”¨ï¼ˆ.[user]ä¿®é¥°ç¬¦ç”¨æ¥å¿«é€Ÿå®šä½æŸ¥æ‰¾ï¼Œä¹Ÿå¯ä»¥èµ·åˆ°å‘½åç©ºé—´çš„ä½œç”¨ï¼‰
 *
 * æ‰¾åˆ°å‘½åç©ºé—´å†…çš„
 * v-auth.user="'api/user/list'"
 * v-auth.user="['api/user/list', 'api/user/list']"
 * v-auth="{ user: ["api/user/list", "api/user/add"], setting: [""] }"
 * v-auth="{ user: "", setting: "" }"
 *
 * userå’Œsettingæ¨¡å—ä¸­ä»»æ„æ‰¾åˆ°
 * v-auth.user.setting="api/user/list"
 * v-auth.user.setting="['api/user/list', 'api/user/add']"
 *
 * tipï¼šè¦æ˜¯æœ‰ userä¸‹é¢ï¼Œæˆ–è€…settingä¸‹é¢æœ‰æŸä¸ªæƒé™éƒ½å¯ä»¥æ˜¾ç¤ºæŒ‰é’®è¿™ç§åœºæ™¯è¯¥æ€ä¹ˆåŠ
 *
 * <button v-auth="{ user: "", setting: "" }"></button>
 * <button v-auth="{ user: ["api/user/list", "api/user/add"], setting: [""] }"></button>
 */

import { isArray, isString, isPlainObject } from 'lodash-es'

const _mockResRouteData = [
  {
    key: 'user',
    name: 'ç”¨æˆ·ç®¡ç†',
    children: [
      {
        key: 'user/list',
        name: 'ç”¨æˆ·åˆ—è¡¨',
        children: [
          { type: 'btn', key: 'api/user/list', name: 'ç”¨æˆ·åˆ—è¡¨æŸ¥çœ‹' },
          { type: 'btn', key: 'api/user/detail', name: 'ç”¨æˆ·è¯¦æƒ…' },
          { type: 'btn', key: 'api/user/auth-edit', name: 'ç”¨æˆ·æƒé™ç¼–è¾‘' }
        ]
      },
      {
        key: 'user/list1',
        name: 'ç”¨æˆ·åˆ—è¡¨1',
        children: [
          { type: 'btn', key: 'api/user/list1', name: 'ç”¨æˆ·åˆ—è¡¨æŸ¥çœ‹1' },
          { type: 'btn', key: 'api/user/detail1', name: 'ç”¨æˆ·è¯¦æƒ…1' },
          { type: 'btn', key: 'api/user/auth-edit1', name: 'ç”¨æˆ·æƒé™ç¼–è¾‘1' }
        ]
      }
    ]
  },
  {
    key: 'setting',
    name: 'è®¾ç½®',
    children: [
      {
        key: 'setting/auth',
        name: 'æƒé™è®¾ç½®',
        children: [
          { type: 'btn', key: 'api/auth/add', name: 'æ–°å¢æƒé™' },
          { type: 'btn', key: 'api/auth/edit', name: 'ç¼–è¾‘æƒé™' },
          { type: 'btn', key: 'api/auth/list', name: 'æƒé™åˆ—è¡¨' }
        ]
      }
    ]
  },
  {
    key: '404',
    name: 'å¼‚å¸¸é¡µé¢',
    children: [
      {
        key: 'exception/404',
        name: '404é¡µé¢',
        children: [
          { type: 'btn', key: 'api/exception/add', name: 'æ–°å¢' },
          { type: 'btn', key: 'api/exception/edit', name: 'ç¼–è¾‘' }
        ]
      },
      {
        key: 'exception/503',
        name: '503é¡µé¢'
      }
    ]
  }
]

// æ¨¡å—å”¯ä¸€æ ‡è¯†key
const KEY_NAME = 'key'
const findNamesRoutes = (moduleName) => {
  return (_mockResRouteData.find((route) => route[KEY_NAME] === moduleName) || {}).children || []
}

const btnKeys = (routes) => {
  const keys = []

  function find(arr) {
    arr.forEach((it) => {
      // æŒ‰é’®ç±»å‹çš„å”¯ä¸€key
      if (it.type === 'btn') {
        keys.push(it[KEY_NAME])
      }

      if (it.children && it.children.length) {
        find(it.children)
      }
    })
  }

  find(routes)

  return keys
}

/**
 * æ¯”å¯¹æ˜¯å¦æœ‰ç›¸åŒé¡¹ï¼Œåªè¦æ‰¾åˆ°ä¸€ä¸ªæœ‰ç›¸åŒçš„ï¼Œå°±ç«‹å³è¿”å›ï¼ˆæˆ–çš„å…³ç³»ï¼Œæ‰€ä»¥å¯ä»¥æå‰è¿”å›ï¼‰
 *
 * arrModuleValue å¿…ç„¶å­˜åœ¨
 */
const hasDuplicates = (arr1, arrModuleValue) => {
  for (let i = 0, len = arrModuleValue.length; i < len; i++) {
    if (arr1.includes(arrModuleValue[i])) {
      return true
    }
  }

  return false
}

const hasPer = (moduleName, moduleValue) => {
  const keys = btnKeys(findNamesRoutes(moduleName))

  if (isString(moduleValue)) {
    return keys.includes(moduleValue)
  }

  if (isArray(moduleValue) && moduleValue.length > 0) {
    return hasDuplicates(keys, moduleValue)
  }

  return false
}

const DOM_MARK = 'data-auth'
const hasMark = (el) => {
  return el.getAttribute(DOM_MARK) === 'true'
}

const setMark = (el) => {
  el.setAttribute(DOM_MARK, true)
}

const removeEl = (el) => {
  el && el.parentNode && el.parentNode.removeChild(el)
}

/**
 * åœºæ™¯2æ–¹å¼å®ç°
 */
export default {
  mounted(el, binding) {
    const { modifiers, value } = binding

    const valueIsPlainObj = isPlainObject(value)
    const routeModules = Object.keys(valueIsPlainObj ? value : modifiers)

    if (routeModules.length) {
      try {
        routeModules.forEach((module) => {
          const curModuleValue = valueIsPlainObj ? value[module] : value
          if (hasPer(module, curModuleValue)) {
            setMark(el)
            throw new Error('å½“å‰elå·²æ‰“æ ‡å¯ç«‹å³è·³å‡º')
          }
        })
      } catch {}
    } else {
      // æ²¡æœ‰å‘½åç©ºé—´ç›´æ¥åˆ é™¤ï¼Œä¾‹ï¼šv-auth='"api/list"'
      removeEl(el)
      return
    }

    if (!hasMark(el)) {
      removeEl(el)
    }
  },

  updated() {},

  unmounted() {}
}
```

3. v-scrollbar è‡ªå®šä¹‰scrollbaræ ·å¼ï¼Œç±»ä¼¼macæ»šåŠ¨æ¡

```js
import Scrollbar from 'smooth-scrollbar'
import config from '@/config/index.js'

const extractProp = (prop) => (obj) => (typeof obj === 'undefined' ? undefined : obj[prop])
const extractOptions = extractProp('options')
const extractEl = extractProp('el')

const bestMatch = (extractor) => (possibilities) =>
  extractor(possibilities.find((p) => typeof extractor(p) !== 'undefined'))
const bestEl = bestMatch(extractEl)
const bestOptions = bestMatch(extractOptions)

/**
 v-scrollbar
 v-scrollbar="{ el: "" }"
 */
export default {
  mounted(el, binding) {
    if (config.useCustomScrollBar) {
      const possibilities = [binding.value]
      const targetEl = bestEl(possibilities)
      const config = bestOptions(possibilities)

      const scrollY = binding.modifiers.y
      const scrollX = binding.modifiers.x
      Scrollbar.init(targetEl ? document.querySelector(targetEl) : el)
    }
  },

  updated(el, binding, vnode, prevVnode) {},

  unmounted(el, binding) {
    if (config.useCustomScrollBar) {
      const possibilities = [binding.value]
      const targetEl = bestEl(possibilities)
      Scrollbar.destroy(targetEl ? document.querySelector(targetEl) : el, {})
    }
  }
}
```

4. v-lazyImg å›¾ç‰‡æ‡’åŠ è½½

```
import { useIntersectionObserver } from '@vueuse/core'

/**
 v-lazyImg="'https://via.placeholder.com/250'"
 */
export default {
  mounted(el, binding) {
    const { stop } = useIntersectionObserver(
      el,
      ([{ isIntersecting }], observerElement) => {
        if (isIntersecting) {
          stop()

          el.src = binding.value
        }
      },
      { threshold: 0 }
    )
  }
}
```
